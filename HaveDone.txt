Fixed error slip
Combined XOR() and XORv()
Added weighted sampling
